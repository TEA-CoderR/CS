Memory initialized with        1024 words
Page table structure (1024-word memory):
  Root PT at 0x0400 (word index 256)
  L2 PT at 0x0800 (word index 512)
  Usable address range: 0x0000-0x00000ffc
========================================
Memory Unit Test Starting (Fixed Version)
========================================

=== Test 1: Reset Functionality ===
PASS: Memory ready after reset

=== Test 2: Read Uninitialized Memory ===
[MEM] Request: addr=0x00000000, word_idx=   0
PASS [                 Start of memory]: addr=0x00000000, data=0x00000000
[MEM] Request: addr=0x00000004, word_idx=   1
PASS [                          Word 1]: addr=0x00000004, data=0x00000000
[MEM] Request: addr=0x00000100, word_idx=  64
PASS [              Different location]: addr=0x00000100, data=0x00000000

=== Test 3: Read Page Table Entries ===
[MEM] Request: addr=0x00000400, word_idx= 256
ERROR [                 Root PT entry 0]: Data mismatch
  Address:  0x00000400
  Expected: 0x00000801
  Got:      0x00000000
[MEM] Request: addr=0x00000404, word_idx= 257
ERROR [                 Root PT entry 1]: Data mismatch
  Address:  0x00000404
  Expected: 0x12340007
  Got:      0x00000801
[MEM] Request: addr=0x00000408, word_idx= 258
ERROR [       Root PT entry 2 (invalid)]: Data mismatch
  Address:  0x00000408
  Expected: 0x00000000
  Got:      0x12340007
[MEM] Request: addr=0x00000800, word_idx= 512
ERROR [                   L2 PT entry 0]: Data mismatch
  Address:  0x00000800
  Expected: 0x1000000f
  Got:      0x00000000
[MEM] Request: addr=0x00000804, word_idx= 513
ERROR [                   L2 PT entry 1]: Data mismatch
  Address:  0x00000804
  Expected: 0x1100000f
  Got:      0x1000000f
[MEM] Request: addr=0x00000808, word_idx= 514
ERROR [                   L2 PT entry 2]: Data mismatch
  Address:  0x00000808
  Expected: 0x12000007
  Got:      0x1100000f
[MEM] Request: addr=0x0000080c, word_idx= 515
ERROR [         L2 PT entry 3 (invalid)]: Data mismatch
  Address:  0x0000080c
  Expected: 0x00000000
  Got:      0x12000007

=== Test 4: Word Alignment Test ===
[MEM] Request: addr=0x00000400, word_idx= 256
ERROR [              Word aligned 0x400]: Data mismatch
  Address:  0x00000400
  Expected: 0x00000801
  Got:      0x00000000
[MEM] Request: addr=0x00000404, word_idx= 257
ERROR [              Word aligned 0x404]: Data mismatch
  Address:  0x00000404
  Expected: 0x12340007
  Got:      0x00000801
[MEM] Request: addr=0x00000408, word_idx= 258
ERROR [              Word aligned 0x408]: Data mismatch
  Address:  0x00000408
  Expected: 0x00000000
  Got:      0x12340007
[MEM] Request: addr=0x0000040c, word_idx= 259
PASS [              Word aligned 0x40C]: addr=0x0000040c, data=0x00000000

=== Test 5: Address Boundary Tests ===
[MEM] Request: addr=0x00000000, word_idx=   0
PASS [                 Start of memory]: addr=0x00000000, data=0x00000000
[MEM] Request: addr=0x00000ffc, word_idx=1023
PASS [        End of range (word 1023)]: addr=0x00000ffc, data=0x00000000

=== Test 6: Out of Range Access ===
[MEM] Request: addr=0x00001000, word_idx=   0
PASS [               Just out of range]: addr=0x00001000, data=0x00000000
[MEM] Request: addr=0x00010000, word_idx=   0
PASS [                Far out of range]: addr=0x00010000, data=0x00000000

=== Test 7: Page Table Structure Scan ===
Root page table area (0x400-0x410):
[MEM] Request: addr=0x00000400, word_idx= 256
  0x00000400 -> 0x00000000
[MEM] Request: addr=0x00000404, word_idx= 257
  0x00000404 -> 0x00000801
[MEM] Request: addr=0x00000408, word_idx= 258
  0x00000408 -> 0x12340007
[MEM] Request: addr=0x0000040c, word_idx= 259
  0x0000040c -> 0x00000000
[MEM] Request: addr=0x00000410, word_idx= 260
  0x00000410 -> 0x00000000
Level 2 page table area (0x800-0x810):
[MEM] Request: addr=0x00000800, word_idx= 512
  0x00000800 -> 0x00000000
[MEM] Request: addr=0x00000804, word_idx= 513
  0x00000804 -> 0x1000000f
[MEM] Request: addr=0x00000808, word_idx= 514
  0x00000808 -> 0x1100000f
[MEM] Request: addr=0x0000080c, word_idx= 515
  0x0000080c -> 0x12000007
[MEM] Request: addr=0x00000810, word_idx= 516
  0x00000810 -> 0x00000000

=== Test 8: Back-to-Back Requests ===
[MEM] Request: addr=0x00000400, word_idx= 256
ERROR [                  Back-to-back 1]: Data mismatch
  Address:  0x00000400
  Expected: 0x00000801
  Got:      0x00000000
[MEM] Request: addr=0x00000800, word_idx= 512
ERROR [                  Back-to-back 2]: Data mismatch
  Address:  0x00000800
  Expected: 0x1000000f
  Got:      0x00000801
[MEM] Request: addr=0x00000404, word_idx= 257
ERROR [                  Back-to-back 3]: Data mismatch
  Address:  0x00000404
  Expected: 0x12340007
  Got:      0x1000000f

=== Test 9: Response Delay Handling ===
[MEM] Request: addr=0x00000400, word_idx= 256
ERROR [                Delayed response]: Data mismatch
  Expected: 0x00000801
  Got:      0x12340007

=== Test 10: Rapid Sequential Requests ===
[MEM] Request: addr=0x00000000, word_idx=   0
ERROR: Rapid test           0 failed. addr=0x00000000, exp=0x00000000, got=0x00000801
[MEM] Request: addr=0x00000400, word_idx= 256
ERROR: Rapid test           1 failed. addr=0x00000400, exp=0x00000801, got=0x00000000
[MEM] Request: addr=0x00000404, word_idx= 257
ERROR: Rapid test           2 failed. addr=0x00000404, exp=0x12340007, got=0x00000801
[MEM] Request: addr=0x00000800, word_idx= 512
ERROR: Rapid test           3 failed. addr=0x00000800, exp=0x1000000f, got=0x12340007
[MEM] Request: addr=0x00000804, word_idx= 513
ERROR: Rapid test           4 failed. addr=0x00000804, exp=0x1100000f, got=0x1000000f

=== Test 11: State Machine Robustness ===
[MEM] Request: addr=0x00000400, word_idx= 256
PASS: State machine handled delayed acceptance correctly
[MEM] Response: data=0x00000801

=== Test 12: Comprehensive Address Test ===
[MEM] Request: addr=0x00000000, word_idx=   0
PASS: Comprehensive test           0
[MEM] Request: addr=0x00000400, word_idx= 256
ERROR: Comprehensive test           1 failed
  addr=0x00000400, exp=0x00000801, got=0x00000000
[MEM] Request: addr=0x00000404, word_idx= 257
ERROR: Comprehensive test           2 failed
  addr=0x00000404, exp=0x12340007, got=0x00000801
[MEM] Request: addr=0x00000408, word_idx= 258
ERROR: Comprehensive test           3 failed
  addr=0x00000408, exp=0x00000000, got=0x12340007
[MEM] Request: addr=0x00000800, word_idx= 512
ERROR: Comprehensive test           4 failed
  addr=0x00000800, exp=0x1000000f, got=0x00000000
[MEM] Request: addr=0x00000804, word_idx= 513
ERROR: Comprehensive test           5 failed
  addr=0x00000804, exp=0x1100000f, got=0x1000000f
[MEM] Request: addr=0x00000808, word_idx= 514
ERROR: Comprehensive test           6 failed
  addr=0x00000808, exp=0x12000007, got=0x1100000f
[MEM] Request: addr=0x0000080c, word_idx= 515
ERROR: Comprehensive test           7 failed
  addr=0x0000080c, exp=0x00000000, got=0x12000007
[MEM] Request: addr=0x00000ffc, word_idx=1023
PASS: Comprehensive test           8
[MEM] Request: addr=0x00001000, word_idx=   0
PASS: Comprehensive test           9

========================================
Memory Test Summary:
  Tests Passed:          13
  Tests Failed:          26
  SOME TESTS FAILED!
========================================
